# =============================================================================
# Terrarium Git - Production Environment Configuration
# =============================================================================
# For production Linux deployments
# Copy to .env for production use
# =============================================================================

# =============================================================================
# ENVIRONMENT
# =============================================================================
ENVIRONMENT=production

# =============================================================================
# DOMAIN & URLs
# =============================================================================
DOMAIN=terrarium-git.terrarium.network
ROOT_URL=https://terrarium-git.terrarium.network/

# External container registry (Zot)
CONTAINER_REGISTRY=containers.terrarium.network

# MinIO (LFS Storage)
MINIO_DOMAIN=terrarium-git-minio1.terrarium.network
MINIO_CONSOLE_PORT=9001
MINIO_API_PORT=9000

# =============================================================================
# TRAEFIK / MANTRAE (Checkpoint)
# =============================================================================
CHECKPOINT_URL=https://checkpoint.terrarium.network
MANTRAE_PROFILE_TOKEN=b5pk6roume
TRAEFIK_ENTRYPOINT=websecure
TRAEFIK_CERT_RESOLVER=letsencrypt

# =============================================================================
# DATABASE (PostgreSQL)
# =============================================================================
# Generate with: openssl rand -base64 32 | tr -d '/+=' | head -c 32
POSTGRES_PASSWORD=GENERATE_ME_FIRST

# =============================================================================
# GITEA ADMIN USER
# =============================================================================
ADMIN_USERNAME=yalefox
ADMIN_EMAIL=yale@terrarium.network
# Auto-generated on first run, stored in .password file
ADMIN_PASSWORD=GENERATE_ME_FIRST

# =============================================================================
# GITEA ACTIONS RUNNERS
# =============================================================================
# Get from: Site Administration > Actions > Runners > Create new Runner
RUNNER_TOKEN=CONFIGURE_AFTER_FIRST_START

# Production: More runners for parallel jobs (adjust based on RAM)
# 8GB RAM = 3 runners, 16GB = 5 runners, 32GB = 8 runners
RUNNER_COUNT=3

# =============================================================================
# MINIO (LFS Object Storage)
# =============================================================================
# Auto-generated on first run
MINIO_ROOT_USER=GENERATE_ME_FIRST
MINIO_ROOT_PASSWORD=GENERATE_ME_FIRST
MINIO_LFS_BUCKET=terrarium-git-lfs-01

# MinIO OIDC (svc-terrarium-git-lfs from Pocket ID)
MINIO_OIDC_CLIENT_ID=c2bb536c-cd99-4e6a-b165-6c2298028c1c
MINIO_OIDC_CLIENT_SECRET=MCI0K5DOOJblR5r8q88VylH9zxrjtMCl
MINIO_OIDC_CONFIG_URL=https://auth.terrarium.network/.well-known/openid-configuration
MINIO_OIDC_CLAIM_NAME=policy
MINIO_OIDC_SCOPES=openid,profile,email

# =============================================================================
# OIDC AUTHENTICATION (Pocket ID) - For Gitea
# =============================================================================
OIDC_ENABLED=true
OIDC_PROVIDER_NAME=Pocket ID
OIDC_CLIENT_ID=3b5ec0af-31c0-4950-99e4-1627b7b7dd41
OIDC_CLIENT_SECRET=yRtLbrGE72yyeDjZ7R6L0YlKAVLWBmBy
OIDC_DISCOVERY_URL=https://auth.terrarium.network/.well-known/openid-configuration

# =============================================================================
# EMAIL (AWS SES)
# =============================================================================
SMTP_ENABLED=true
SMTP_HOST=email-smtp.us-east-1.amazonaws.com
SMTP_PORT=587
SMTP_USER=AKIAYJIBUXQOWNNRL7WW
SMTP_PASSWORD=BCc+L6//bx+yCsByHwwRX6wYL1XOBGKwWEjP/t9a1hgt
SMTP_FROM=noreply@terrarium.network

# =============================================================================
# SSH
# =============================================================================
SSH_PORT=2222

# =============================================================================
# DATA PATHS (for bind mounts - easy rsync backups)
# =============================================================================
DATA_ROOT=/opt/terrarium-git/data
POSTGRES_DATA=${DATA_ROOT}/postgres
GITEA_DATA=${DATA_ROOT}/gitea
MINIO_DATA=${DATA_ROOT}/minio

# =============================================================================
# VERSIONS (pin versions for production stability)
# =============================================================================
GITEA_VERSION=1.23
POSTGRES_VERSION=17-alpine
RUNNER_VERSION=latest
MINIO_VERSION=RELEASE.2024-12-18T13-15-44Z

# =============================================================================
# PRODUCTION SETTINGS
# =============================================================================
# Log level (info for production, debug for troubleshooting)
LOG_LEVEL=info

# Watchtower: disable auto-updates in production, update manually
WATCHTOWER_ENABLED=false

# =============================================================================
# WAZUH AGENT (Log Shipping)
# =============================================================================
WAZUH_MANAGER=wazuh.terrarium.network
WAZUH_AGENT_GROUP=terrarium-services
WAZUH_VERSION=4.14.1

# =============================================================================
# SERVER IP (for Traefik routing and job container networking)
# =============================================================================
# This IP is used for:
# 1. Traefik route configuration via Mantrae
# 2. Act runner job containers to resolve the Gitea domain
# MUST be set to the production server's internal IP
SERVER_IP=172.16.1.153
